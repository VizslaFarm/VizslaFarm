(this["webpackJsonppancake-frontend"]=this["webpackJsonppancake-frontend"]||[]).push([[28],{1710:function(e,t,n){"use strict";n.r(t);var r,a,c=n(25),i=n(6),s=n.n(i),o=n(10),u=n(9),p=n(8),d=n(5),l=n(7),f=n(36),b=n(1),m=n(988),g=n(52),x=n(0),h=Object(m.a)("https://timqecpgicfojmdesoie.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRpbXFlY3BnaWNmb2ptZGVzb2llIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjI4NTgwMzksImV4cCI6MjAzODQzNDAzOX0.WaaYVv4zd0YL9sK7tR-7D7qJ7biRRqKl1lFwiI2HsZc"),j=[{inputs:[{internalType:"string",name:"_newName",type:"string"}],name:"changeName",outputs:[],stateMutability:"nonpayable",type:"function"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"string",name:"oldName",type:"string"},{indexed:!1,internalType:"string",name:"newName",type:"string"}],name:"NameChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"string",name:"name",type:"string"}],name:"NameRegistered",type:"event"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"registerName",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_name",type:"string"}],name:"getAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_user",type:"address"}],name:"getName",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"getUserCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],y=l.e.div(r||(r=Object(p.a)(["\n  padding: 20px; \n  max-width: 800px; \n  margin: 20px auto;\n  background: ",";\n  border-radius: 15px;\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n"])),(function(e){return e.theme.colors.background})),O=l.e.h1(a||(a=Object(p.a)(["\n  text-align: center;\n  color: ",";\n  font-size: 28px;\n  margin-bottom: 20px;\n  font-family: 'Arial', sans-serif;\n"])),(function(e){return e.theme.colors.primary})),v={container:{display:"flex",flexDirection:"column",alignItems:"center",width:"400px",margin:"0 auto",padding:"10px",border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#000"},chatBox:{width:"100%",height:"300px",overflowY:"scroll",marginBottom:"10px",padding:"10px",border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#000",color:"#fff"},messageContainer:{display:"flex",alignItems:"center",padding:"5px 0"},avatar:{width:"30px",height:"30px",marginRight:"10px",borderRadius:"50%"},message:{flex:1},input:{width:"100%",padding:"10px",marginBottom:"10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#fff",color:"#000"},button:{width:"100%"},topListBox:{width:"100%",padding:"10px",border:"1px solid #ccc",borderRadius:"8px",backgroundColor:"#000",color:"#fff",marginTop:"40px",textAlign:"center"},topList:{listStyle:"none",padding:"0",margin:"10px 0"},timestamp:{display:"block",fontSize:"0.8em",color:"#aaa",marginTop:"5px"},paginationButton:{margin:"5px",backgroundColor:"#333",color:"#fff","&:hover":{backgroundColor:"#555"}}};t.default=function(){var e=Object(f.useWeb3React)().account,t=Object(d.useState)([]),n=Object(u.a)(t,2),r=n[0],a=n[1],i=Object(d.useState)(""),p=Object(u.a)(i,2),l=p[0],m=p[1],w=Object(d.useState)(0),k=Object(u.a)(w,2),C=k[0],E=k[1],I=Object(d.useRef)(null),T=Object(d.useState)([]),M=Object(u.a)(T,2),N=M[0],F=M[1],R=Object(d.useState)([]),D=Object(u.a)(R,2),A=D[0],B=D[1],S=Object(d.useState)(1),z=Object(u.a)(S,2),J=z[0],L=z[1],Z=Object(d.useState)({}),Y=Object(u.a)(Z,2),V=Y[0],X=Y[1],_=Object(d.useMemo)((function(){return new g.ethers.providers.Web3Provider(window.ethereum)}),[]),W=Object(d.useMemo)((function(){return new g.ethers.Contract("0x674e3eDc898Aa4b486Bd2E5aa2D1C8653677F471",j,_)}),[_]);Object(d.useEffect)((function(){var e=function(){var e=Object(o.a)(s.a.mark((function e(){var t,n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.from("messages").select("*").order("timestamp",{ascending:!0});case 2:t=e.sent,n=t.data,(r=t.error)?console.error("Error fetching messages:",r):(a(n||[]),P(n||[]));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();fetch("http://localhost:3001/proxy?url=https://statx.hu/pixel-track/gLv9fZ52ZvzweVeF").then((function(e){return e.json()})).then((function(e){console.log(e)})).catch((function(e){console.error("Error:",e)})),e();var t=h.channel("public:messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},(function(e){a((function(t){var n=[].concat(Object(c.a)(t),[e.new]);return P(n),n}))})).subscribe();return function(){h.removeChannel(t)}}),[]),Object(d.useEffect)((function(){I.current&&(I.current.scrollTop=I.current.scrollHeight)}),[r]),Object(d.useEffect)((function(){if(C>0){var e=setTimeout((function(){return E(C-1)}),1e3);return function(){return clearTimeout(e)}}}),[C]),Object(d.useEffect)((function(){e&&function(){var e=Object(o.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},n=N.map(function(){var e=Object(o.a)(s.a.mark((function e(n){var r,a,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(u.a)(n,1),a=r[0],e.prev=1,e.next=4,W.getName(a);case 4:(c=e.sent)&&(t[a]=c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("Error fetching name for ".concat(a,":"),e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.all(n);case 4:X(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[N,e,W]);var q=function(){var t=Object(o.a)(s.a.mark((function t(){var n,r,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(C>0)){t.next=2;break}return t.abrupt("return");case 2:if(""!==l.trim()){t.next=4;break}return t.abrupt("return");case 4:return n={text:l,sender:e,timestamp:new Date},t.next=7,h.from("messages").insert([n]);case 7:r=t.sent,i=r.data,(o=r.error)?console.error("Error inserting message:",o):(a((function(e){var t=[].concat(Object(c.a)(e),Object(c.a)(i||[]));return P(t),t})),m(""),E(30));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),P=function(e){var t=new Map;e.forEach((function(e){e.text&&""!==e.text.trim()&&t.set(e.sender,(t.get(e.sender)||0)+1)}));var n=Array.from(t.entries()).sort((function(e,t){return t[1]-e[1]}));F(n);var r=n.slice(0,25).map((function(e){return Object(u.a)(e,1)[0]}));B(r)},G=function(e){L(e)},H=function(e){return"0xEa9C8f2D9d91cF44206F0d869b9cc39897a13Ae1"===e?"Admin":V[e]||"".concat(e.substring(0,5),"...").concat(e.substring(e.length-5))},K=function(e){if("0xEa9C8f2D9d91cF44206F0d869b9cc39897a13Ae1"===e)return{color:"gold"};if(A.includes(e))return{color:"#d4af37"};var t=N.findIndex((function(t){return Object(u.a)(t,1)[0]===e}));if(t>=0){if(t<25)return{color:"#d4af37"};if(t<100)return{color:"#E5E4E2"};if(t<250)return{color:"#cd7f32"}}return{color:"#fff"}},Q=function(e){var t=new Date(e),n=new Date,r=Math.floor((n-t)/1e3);if(r<60)return"".concat(r," seconds ago");if(r<3600){var a=Math.floor(r/60);return"".concat(a," minutes ago")}if(r<86400){var c=Math.floor(r/3600);return"".concat(c," hours ago")}var i=Math.floor(r/86400);return"".concat(i," days ago")},U=function(e){return e<25?"#d4af37":e<100?"#E5E4E2":e<250?"#cd7f32":"#fff"},$=25*(J-1),ee=$+25,te=N.slice($,ee),ne=Math.ceil(N.length/25);return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(y,{children:[Object(x.jsx)(O,{children:"Chat"}),Object(x.jsxs)("div",{style:v.container,children:[Object(x.jsx)("div",{style:v.chatBox,ref:I,children:r.length>0?r.map((function(e){return Object(x.jsxs)("div",{style:v.messageContainer,children:[Object(x.jsx)("img",{src:(t=e.sender,"0xEa9C8f2D9d91cF44206F0d869b9cc39897a13Ae1"===t?"images/pixel/LogoDark.png":"images/pixel/200.png"),alt:"sender",style:v.avatar}),Object(x.jsxs)("div",{style:v.message,children:[Object(x.jsxs)("b",{style:K(e.sender),children:[H(e.sender),":"]})," ",e.text,Object(x.jsx)("span",{style:v.timestamp,children:Q(e.timestamp)})]})]},e.id);var t})):Object(x.jsx)("div",{style:v.message,children:"No messages yet."})}),Object(x.jsx)("input",{type:"text",value:l,onChange:function(e){return m(e.target.value)},style:v.input,placeholder:C>0?"Cooldown: ".concat(C,"s"):"Type a message",disabled:C>0}),Object(x.jsx)(b.m,{onClick:q,style:v.button,disabled:C>0,children:"Send"})]}),Object(x.jsxs)("div",{style:v.topListBox,children:[Object(x.jsx)("h3",{children:"Top List"}),Object(x.jsx)("ul",{style:v.topList,children:te.map((function(e,t){var n=Object(u.a)(e,2),r=n[0],a=n[1];return Object(x.jsxs)("li",{style:{color:U($+t)},children:[$+t+1,". ","0xEa9C8f2D9d91cF44206F0d869b9cc39897a13Ae1"===r?Object(x.jsx)("b",{children:"Admin"}):H(r),": ",a," messages"]},r)}))}),Object(x.jsxs)("div",{children:[J>1&&Object(x.jsx)(b.m,{onClick:function(){return G(J-1)},style:v.paginationButton,children:"Previous"}),function(){for(var e=[],t=J,n=0;n<3&&t+n<=ne;n++)e.push(t+n);return e}().map((function(e){return Object(x.jsx)(b.m,{onClick:function(){return G(e)},style:v.paginationButton,children:e},e)})),J<ne&&Object(x.jsx)(b.m,{onClick:function(){return G(J+1)},style:v.paginationButton,children:"Next"})]})]})]})})}}}]);
//# sourceMappingURL=28.533309ab.chunk.js.map